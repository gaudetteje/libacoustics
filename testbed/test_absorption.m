
%close all
clear
clc
figure
% Calculate absorption coefficient across frequency for various humidity levels
F = 10.^(1:.01:6);
H = (10:10:100);
for h=H
    calcAbsorptionCoef(F,h,20);
    hold on
end


% data copied from Table 1(j), pg. 9, of ANSI-ASA S1.26-1995 (R2009)
F = [50 63 80 100 125 160 200 250 315 400 500 630 800 1000 1250 1600 2000 2500 3150 4000 5000 6300 8000 10000];
H = (10:10:50);
a10 = 1e-3 .* [0.270 0.370 0.487 0.662 0.775 0.965 1.22 1.58 2.12 2.95 4.25 6.26 9.36 14.1 21.1 31.3 45.3 63.5 85.4 109 133 156 175 193];
a20 = 1e-3 .* [0.174 0.260 0.377 0.529 0.712 0.919 1.14 1.39 1.69 2.06 2.60 3.39 4.62 6.53 9.53 14.2 21.5 32.6 49.4 74.1 109 156 215 284];
a30 = 1e-3 .* [0.125 0.192 0.290 0.429 0.615 0.848 1.12 1.42 1.75 2.10 2.52 3.06 3.84 5.00 6.81 9.63 14.1 21.0 31.8 48.5 73.8 112 166 242];
a40 = 1e-3 .* [0.0965 0.150 0.231 0.351 0.521 0.752 1.05 1.39 1.78 2.19 2.63 3.13 3.77 4.65 5.97 8.00 11.2 16.1 23.9 36.1 55.1 84.2 128 194];
a50 = 1e-3 .* [0.0784 0.123 0.191 0.294 0.445 0.660 0.950 1.32 1.75 2.23 2.73 3.27 3.89 4.66 5.75 7.37 9.85 13.7 19.8 29.4 44.4 67.8 104 159];


loglog(F,[a10;a20;a30;a40;a50],'--r');
grid on
